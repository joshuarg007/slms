!function(){"use strict";if(document.getElementById("site2crm-chat-widget"))return;let e=document.currentScript;if(!e){const t=document.querySelectorAll("script[data-widget-key]");t.length>0&&(e=t[t.length-1])}const t=e?.getAttribute("data-widget-key");if(!t)return void console.error("Site2CRM Chat Widget: Missing data-widget-key attribute");const i=e?.getAttribute("data-exclude-paths"),r=i?i.split(",").map(function(e){return e.trim()}):[],a=parseInt(e?.getAttribute("data-z-index"),10)||999998,n=a+1;function o(){return function(e){for(var t=0;t<r.length;t++){var i=r[t];if(i.endsWith("*")){if(e.startsWith(i.slice(0,-1)))return!0}else if(e===i)return!0}return!1}(window.location.pathname)||"true"===localStorage.getItem("site2crm_hide_chat")||document.cookie.includes("site2crm_hide_chat=true")}function s(e,t,i){try{if("get"===e)return sessionStorage.getItem(t);if("set"===e)return sessionStorage.setItem(t,i),i}catch(e){return null}}function l(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}var c="https://api.site2crm.io/api/public/chat-widget";var d,p,u,b,g,x,h,f,m=function(){var e=s("get","s2c_chat_session");if(e)return e;var t="s2c_"+Date.now().toString(36)+"_"+Math.random().toString(36).substr(2,9);return s("set","s2c_chat_session",t),t}(),y=!1,v=!1,w=null,k=[],_=0,C={small:{size:52,icon:26},medium:{size:64,icon:30},large:{size:76,icon:36}};var M={chat:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/><circle cx="12" cy="12" r="1" fill="currentColor"/><circle cx="8" cy="12" r="1" fill="currentColor"/><circle cx="16" cy="12" r="1" fill="currentColor"/></svg>',message:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/><line x1="2" y1="20" x2="8" y2="14" opacity="0.5"/><line x1="22" y1="20" x2="16" y2="14" opacity="0.5"/></svg>',support:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/><circle cx="12" cy="12" r="2" opacity="0.4"/><path d="M12 14v3" opacity="0.4"/></svg>',robot:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="8" width="18" height="12" rx="2"/><circle cx="9" cy="14" r="1.5" fill="currentColor"/><circle cx="15" cy="14" r="1.5" fill="currentColor"/><path d="M12 2v4"/><circle cx="12" cy="2" r="1" fill="currentColor"/><path d="M8 17h8" stroke-linecap="round"/><path d="M1 12h2M21 12h2" opacity="0.5"/></svg>',sparkle:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l2.4 7.2H22l-6.2 4.5 2.4 7.3L12 16.5 5.8 21l2.4-7.3L2 9.2h7.6L12 2z"/><circle cx="19" cy="5" r="1.5" fill="currentColor" opacity="0.6"/><circle cx="5" cy="19" r="1" fill="currentColor" opacity="0.4"/><path d="M19 2v2M18 3h2" opacity="0.5"/></svg>',wave:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L4 14h7l-1 8 9-12h-7l1-8z"/><path d="M17 6l2-2M19 10h2M17 14l2 2" opacity="0.4"/></svg>',ai:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="4" opacity="0.5"/><circle cx="12" cy="12" r="1" fill="currentColor"/><path d="M12 3v2M12 19v2M3 12h2M19 12h2" opacity="0.6"/><path d="M5.6 5.6l1.4 1.4M17 17l1.4 1.4M5.6 18.4l1.4-1.4M17 7l1.4-1.4" opacity="0.4"/></svg>'},z='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>',S='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>',E='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>';async function L(){try{if(!(w=await async function(e){for(var i=0;i<=e;i++){try{var r=await fetch(c+"/config/"+t);if(r.ok)return await r.json();if(r.status>=400&&r.status<500)return null}catch(t){if(i===e)return null}await new Promise(function(e){setTimeout(e,1e3*Math.pow(2,i))})}return null}(2)))return void console.warn("Site2CRM Chat Widget: Unable to load config");(p=document.createElement("div")).id="site2crm-chat-widget",document.body.appendChild(p),d=p.attachShadow({mode:"open"});var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap",d.appendChild(e);var i=document.createElement("style");i.textContent=function(e){var t,i,r,o=e.primary_color||"#6366f1",s=e.chat_bg_color||"#0f0f23",l=e.user_bubble_color||o,c=e.bot_bubble_color||"#1e1e3f",d=C[e.button_size]||C.medium,p=e.button_shape||"bubble",u=e.gradient_type||"none",b=e.gradient_color_1,g=e.gradient_color_2,x=e.gradient_color_3,h=null!=e.gradient_angle?e.gradient_angle:135,f=null!=e.button_opacity?e.button_opacity:1,m=e.blur_background||!1,y=e.attention_effect||"none",v=e.shadow_style||"elevated",w=e.entry_animation||"scale",k=function(e){var t=e.replace("#","");return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)]},_=k(o),M=function(e){return"rgba("+_[0]+", "+_[1]+", "+_[2]+", "+e+")"},z=(t=40,i=k(o),"rgb("+Math.min(255,i[0]+t)+", "+Math.min(255,i[1]+t)+", "+Math.min(255,i[2]+t)+")"),S={sunset:["#f97316","#ec4899"],ocean:["#06b6d4","#3b82f6"],forest:["#22c55e","#14b8a6"],purple:["#8b5cf6","#ec4899"],fire:["#ef4444","#f97316"],midnight:["#1e3a8a","#7c3aed"],aurora:["#06b6d4","#8b5cf6","#ec4899"]};if("none"===u)r=o;else if("custom"===u){var E=[b,g,x].filter(Boolean);r=E.length>1?"linear-gradient("+h+"deg, "+E.join(", ")+")":o}else r=S[u]?"linear-gradient("+h+"deg, "+S[u].join(", ")+")":o;var L,A,T={bubble:{radius:"50%",width:d.size+"px",height:d.size+"px",layout:"icon"},pill:{radius:"9999px",width:1.8*d.size+"px",height:.85*d.size+"px",layout:"icon-text"},square:{radius:"16px",width:d.size+"px",height:d.size+"px",layout:"icon"},tab:{radius:"12px 0 0 12px",width:.7*d.size+"px",height:1.6*d.size+"px",layout:"icon-vertical"},bar:{radius:"16px 16px 0 0",width:3*d.size+"px",height:.75*d.size+"px",layout:"icon-text"}},q=T[p]||T.bubble,j={none:"none",subtle:"0 4px 12px rgba(0,0,0,0.15)",elevated:"0 8px 32px "+M(.4)+", 0 0 0 1px rgba(255, 255, 255, 0.1) inset, 0 2px 4px rgba(0, 0, 0, 0.1)",dramatic:"0 20px 60px rgba(0,0,0,0.4), 0 8px 24px "+M(.3),glow:"0 0 20px "+o+"80, 0 0 40px "+o+"40, 0 8px 32px rgba(0,0,0,0.3)"},Y=j[v]||j.elevated,I="none"===v?"none":"glow"===v?"0 0 30px "+o+"90, 0 0 60px "+o+"60, 0 12px 40px rgba(0,0,0,0.3)":"dramatic"===v?"0 24px 70px rgba(0,0,0,0.5), 0 12px 32px "+M(.4):"0 12px 40px "+M(.5)+", 0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 4px 8px rgba(0, 0, 0, 0.15)",B="",H="none",D="";return"pulse"===y?(H="s2c-pulse 2s ease-out infinite",D="@keyframes s2c-pulse { 0% { transform: scale(1); opacity: 0.5; } 100% { transform: scale(1.4); opacity: 0; } }"):"bounce"===y?(B="animation: s2c-bounce 2s ease-in-out infinite;",D="@keyframes s2c-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }"):"glow"===y?(B="animation: s2c-glow 2s ease-in-out infinite;",D="@keyframes s2c-glow { 0%, 100% { box-shadow: "+Y+"; } 50% { box-shadow: 0 0 30px "+o+"90, 0 0 60px "+o+"50, 0 8px 32px rgba(0,0,0,0.3); } }"):"shake"===y?(B="animation: s2c-shake 3s ease-in-out infinite;",D="@keyframes s2c-shake { 0%, 90%, 100% { transform: rotate(0); } 92% { transform: rotate(-8deg); } 94% { transform: rotate(8deg); } 96% { transform: rotate(-6deg); } 98% { transform: rotate(6deg); } }"):"ring"===y&&(H="s2c-ring 2s ease-out infinite",D="@keyframes s2c-ring { 0% { transform: scale(1); opacity: 0.6; box-shadow: 0 0 0 0 "+o+"80; } 100% { transform: scale(1.5); opacity: 0; box-shadow: 0 0 0 12px "+o+"00; } }"),"fade"===w?(L="s2c-fade-in",A="@keyframes s2c-fade-in { from { opacity: 0; } to { opacity: 1; } }"):"slide"===w?(L="s2c-slide-in",A="@keyframes s2c-slide-in { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }"):"bounce"===w?(L="s2c-bounce-in",A="@keyframes s2c-bounce-in { 0% { opacity: 0; transform: translateY(30px) scale(0.9); } 50% { transform: translateY(-8px) scale(1.02); } 100% { opacity: 1; transform: translateY(0) scale(1); } }"):"none"===w?(L="none",A=""):(L="s2c-scale-in",A="@keyframes s2c-scale-in { from { opacity: 0; transform: translateY(24px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }"),"*, *::before, *::after {  box-sizing: border-box;  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;  margin: 0;  padding: 0;}.s2c-bubble {  position: fixed;  width: "+q.width+";  height: "+q.height+";  border-radius: "+q.radius+";  cursor: pointer;  display: flex;  align-items: center;  justify-content: center;"+("icon-text"===q.layout?"  gap: 8px;":"")+("icon-vertical"===q.layout?"  flex-direction: column;":"")+"  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);  z-index: "+a+";  background: "+r+";  opacity: "+f+";  box-shadow: "+Y+";"+(m?"  backdrop-filter: blur(10px);":"")+"  "+B+"  border: none;  outline: none;}.s2c-bubble::before {  content: '';  position: absolute;  inset: 0;  border-radius: "+q.radius+";  padding: 1px;  background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.05));  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);  -webkit-mask-composite: xor;  mask-composite: exclude;  pointer-events: none;}.s2c-bubble:hover {  transform: scale(1.1) translateY(-2px);  box-shadow: "+I+";}.s2c-bubble:active {  transform: scale(1.05);}.s2c-bubble:focus-visible {  outline: 2px solid white;  outline-offset: 3px;}.s2c-bubble svg {  width: "+d.icon+"px;  height: "+d.icon+"px;  color: white;  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));  transition: transform 0.3s ease;}.s2c-bubble .s2c-bubble-label {  color: white;  font-size: 14px;  font-weight: 600;  white-space: nowrap;}.s2c-bubble:hover svg {  transform: scale(1.1);}.s2c-bubble.bottom-right {  bottom: calc("+("bar"===p?"0px":"24px")+" + env(safe-area-inset-bottom, 0px));  right: "+("tab"===p?"0":"24px")+";}.s2c-bubble.bottom-left {  bottom: calc("+("bar"===p?"0px":"24px")+" + env(safe-area-inset-bottom, 0px));  left: "+("tab"===p?"0":"24px")+";}"+("tab"===p?".s2c-bubble.bottom-left { border-radius: 0 12px 12px 0; }":"")+("bar"===p?".s2c-bubble.bottom-right, .s2c-bubble.bottom-left { right: auto; left: 50%; transform: translateX(-50%); }.s2c-bubble.bottom-right:hover, .s2c-bubble.bottom-left:hover { transform: translateX(-50%) translateY(-2px); }":"")+".s2c-bubble::after {  content: '';  position: absolute;  width: 100%;  height: 100%;  border-radius: "+q.radius+";  background: inherit;  animation: "+H+";  z-index: -1;"+("none"===H?"  display: none;":"")+"}"+D+".s2c-window {  position: fixed;  width: 400px;  height: 560px;  max-height: calc(100vh - 100px);  border-radius: 24px;  background: linear-gradient(180deg, "+s+" 0%, #0a0a1a 100%);  box-shadow: 0 32px 64px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.08), 0 0 80px "+M(.15)+";  display: none;  flex-direction: column;  overflow: hidden;  z-index: "+n+";}.s2c-window.open {  display: flex;  animation: "+L+" 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);}"+A+".s2c-window.bottom-right {  bottom: calc("+(d.size+40)+"px + env(safe-area-inset-bottom, 0px));  right: 24px;}.s2c-window.bottom-left {  bottom: calc("+(d.size+40)+"px + env(safe-area-inset-bottom, 0px));  left: 24px;}@media (max-width: 480px) {  .s2c-window {    width: calc(100vw - 16px);    height: 65vh !important;    max-height: 450px !important;    bottom: calc(70px + env(safe-area-inset-bottom, 0px)) !important;    right: 8px !important;    left: 8px !important;    border-radius: 20px;  }  .s2c-bubble {    bottom: calc("+("bar"===p?"0px":"16px")+" + env(safe-area-inset-bottom, 0px)) !important;    right: "+("tab"===p?"0":"16px")+" !important;  }}.s2c-header {  padding: 20px 24px;  background: "+(r.includes("gradient")?r:"linear-gradient(135deg, "+o+" 0%, "+z+" 100%)")+";  color: white;  display: flex;  align-items: center;  justify-content: space-between;  flex-shrink: 0;  position: relative;  overflow: hidden;}.s2c-header::before {  content: '';  position: absolute;  top: -50%;  right: -20%;  width: 200px;  height: 200px;  background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);  pointer-events: none;}.s2c-header-info {  display: flex;  flex-direction: column;  position: relative;  z-index: 1;}.s2c-header-title {  font-size: 17px;  font-weight: 700;  display: flex;  align-items: center;  gap: 10px;  letter-spacing: -0.02em;}.s2c-status-dot {  width: 10px;  height: 10px;  background: #22c55e;  border-radius: 50%;  flex-shrink: 0;  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.25), 0 0 12px rgba(34, 197, 94, 0.5);  animation: s2c-status-pulse 2s ease-in-out infinite;}@keyframes s2c-status-pulse {  0%, 100% { box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.25), 0 0 12px rgba(34, 197, 94, 0.5); }  50% { box-shadow: 0 0 0 5px rgba(34, 197, 94, 0.15), 0 0 20px rgba(34, 197, 94, 0.6); }}.s2c-header-subtitle {  font-size: 13px;  opacity: 0.9;  margin-top: 4px;  margin-left: 20px;  font-weight: 500;}.s2c-close {  background: rgba(255, 255, 255, 0.15);  border: none;  color: white;  cursor: pointer;  padding: 8px;  border-radius: 12px;  transition: all 0.2s ease;  position: relative;  z-index: 1;  backdrop-filter: blur(10px);}.s2c-close:hover {  background: rgba(255, 255, 255, 0.25);  transform: scale(1.05);}.s2c-close:focus-visible {  outline: 2px solid white;  outline-offset: 2px;}.s2c-close svg {  width: 18px;  height: 18px;  display: block;}.s2c-messages {  flex: 1;  padding: 20px;  overflow-y: auto;  display: flex;  flex-direction: column;  gap: 16px;  background: "+s+";  scrollbar-width: thin;  scrollbar-color: rgba(255,255,255,0.1) transparent;}.s2c-messages::-webkit-scrollbar { width: 6px; }.s2c-messages::-webkit-scrollbar-track { background: transparent; }.s2c-messages::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }.s2c-message {  max-width: 85%;  padding: 14px 18px;  font-size: 14px;  line-height: 1.6;  animation: s2c-message-in 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);  letter-spacing: -0.01em;}@keyframes s2c-message-in {  from { opacity: 0; transform: translateY(12px) scale(0.95); }  to { opacity: 1; transform: translateY(0) scale(1); }}.s2c-message.user {  align-self: flex-end;  background: linear-gradient(135deg, "+l+" 0%, "+z+" 100%);  color: white;  border-radius: 20px 20px 6px 20px;  box-shadow: 0 4px 16px "+M(.3)+";}.s2c-message.assistant {  align-self: flex-start;  background: "+c+";  color: #e5e7eb;  border-radius: 20px 20px 20px 6px;  border: 1px solid rgba(255, 255, 255, 0.06);  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);}.s2c-typing {  display: flex;  gap: 6px;  padding: 16px 20px;  align-self: flex-start;  background: "+c+";  border-radius: 20px 20px 20px 6px;  border: 1px solid rgba(255, 255, 255, 0.06);}.s2c-typing-dot {  width: 8px;  height: 8px;  background: linear-gradient(135deg, "+o+", "+z+");  border-radius: 50%;  animation: s2c-typing 1.4s ease-in-out infinite;}.s2c-typing-dot:nth-child(2) { animation-delay: 0.2s; }.s2c-typing-dot:nth-child(3) { animation-delay: 0.4s; }@keyframes s2c-typing {  0%, 100% { opacity: 0.3; transform: scale(0.8) translateY(0); }  50% { opacity: 1; transform: scale(1) translateY(-4px); }}.s2c-quick-replies {  display: flex;  flex-wrap: wrap;  gap: 10px;  padding: 0 20px 16px;  background: "+s+";}.s2c-quick-reply {  padding: 10px 18px;  background: "+M(.1)+";  border: 1px solid "+M(.3)+";  border-radius: 24px;  font-size: 13px;  color: "+z+";  cursor: pointer;  transition: all 0.25s ease;  font-weight: 600;  letter-spacing: -0.01em;}.s2c-quick-reply:hover {  background: linear-gradient(135deg, "+o+" 0%, "+z+" 100%);  color: white;  border-color: transparent;  transform: translateY(-2px);  box-shadow: 0 4px 16px "+M(.4)+";}.s2c-quick-reply:focus-visible {  outline: 2px solid "+z+";  outline-offset: 2px;}.s2c-input-area {  padding: 16px 20px calc(20px + env(safe-area-inset-bottom, 0px));  display: flex;  gap: 12px;  background: linear-gradient(180deg, "+s+" 0%, #080814 100%);  flex-shrink: 0;  border-top: 1px solid rgba(255, 255, 255, 0.06);}.s2c-input {  flex: 1;  padding: 14px 20px;  border: 1px solid rgba(255, 255, 255, 0.1);  border-radius: 16px;  font-size: 14px;  outline: none;  transition: all 0.25s ease;  color: #f3f4f6;  background: rgba(255, 255, 255, 0.05);  font-weight: 500;}.s2c-input:focus {  background: rgba(255, 255, 255, 0.08);  border-color: "+M(.5)+";  box-shadow: 0 0 0 3px "+M(.15)+";}.s2c-input::placeholder { color: #6b7280; }.s2c-send {  width: 48px;  height: 48px;  border: none;  border-radius: 16px;  cursor: pointer;  display: flex;  align-items: center;  justify-content: center;  transition: all 0.25s ease;  background: linear-gradient(135deg, "+o+" 0%, "+z+" 100%);  flex-shrink: 0;  box-shadow: 0 4px 16px "+M(.3)+";}.s2c-send:disabled {  opacity: 0.5;  cursor: not-allowed;  box-shadow: none;}.s2c-send:not(:disabled):hover {  transform: scale(1.05) translateY(-1px);  box-shadow: 0 6px 24px "+M(.45)+";}.s2c-send:not(:disabled):active {  transform: scale(0.98);}.s2c-send:focus-visible {  outline: 2px solid white;  outline-offset: 2px;}.s2c-send svg {  width: 20px;  height: 20px;  fill: white;}.s2c-powered {  padding: 12px;  text-align: center;  font-size: 11px;  color: #6b7280;  background: #080814;  border-top: 1px solid rgba(255, 255, 255, 0.04);}.s2c-powered a {  color: "+z+";  text-decoration: none;  font-weight: 600;  transition: color 0.2s;}.s2c-powered a:hover { color: "+z+"; }.s2c-powered.hidden { display: none; }.s2c-link-btn {  display: inline-flex;  align-items: center;  gap: 8px;  margin-top: 12px;  padding: 12px 24px;  background: linear-gradient(135deg, "+o+" 0%, "+z+" 100%);  color: white !important;  text-decoration: none;  border-radius: 14px;  font-weight: 700;  font-size: 14px;  transition: all 0.25s ease;  box-shadow: 0 4px 16px "+M(.35)+";  letter-spacing: -0.01em;}.s2c-link-btn:hover {  transform: translateY(-2px);  box-shadow: 0 8px 24px "+M(.45)+";}.s2c-link-btn svg { width: 16px; height: 16px; }.s2c-sr-only {  position: absolute;  width: 1px;  height: 1px;  padding: 0;  margin: -1px;  overflow: hidden;  clip: rect(0, 0, 0, 0);  white-space: nowrap;  border: 0;}"}(w),d.appendChild(i),function(){var e=w.widget_position||"bottom-right",t=w.bubble_icon||"sparkle",i=M[t]||M.sparkle,r=w.header_title||w.business_name,a=w.header_subtitle||"Typically replies instantly",n=!1!==w.show_branding,o=w.button_shape||"bubble";(u=document.createElement("button")).className="s2c-bubble "+e,u.setAttribute("aria-label","Open chat"),u.innerHTML="pill"===o?i+'<span class="s2c-bubble-label">Chat</span>':"bar"===o?i+'<span class="s2c-bubble-label">Chat with us</span>':i;u.addEventListener("click",A),(b=document.createElement("div")).className="s2c-window "+e,b.setAttribute("role","dialog"),b.setAttribute("aria-label",l(r)+" chat"),b.setAttribute("aria-hidden","true");var s="";w.quick_replies&&w.quick_replies.length>0&&(s='<div class="s2c-quick-replies">'+w.quick_replies.map(function(e){return'<button class="s2c-quick-reply">'+l(e)+"</button>"}).join("")+"</div>");var c=n?'<div class="s2c-powered">Powered by <a href="https://site2crm.io" target="_blank" rel="noopener">Site2CRM</a></div>':'<div class="s2c-powered hidden"></div>';b.innerHTML='<div class="s2c-header">  <div class="s2c-header-info">    <div class="s2c-header-title">      <span class="s2c-status-dot" aria-hidden="true"></span>      '+l(r)+"    </div>"+(a?'    <div class="s2c-header-subtitle">'+l(a)+"</div>":"")+'  </div>  <button class="s2c-close" aria-label="Close chat">'+z+'</button></div><div class="s2c-messages" role="log" aria-live="polite" aria-label="Chat messages"></div>'+s+'<div class="s2c-input-area">  <input type="text" class="s2c-input" placeholder="Type your message..." aria-label="Type your message" />  <button class="s2c-send" aria-label="Send message">'+S+"</button></div>"+c,g=b.querySelector(".s2c-messages"),x=b.querySelector(".s2c-input"),h=b.querySelector(".s2c-send"),f=b.querySelector(".s2c-quick-replies");var p=b.querySelector(".s2c-close");p.addEventListener("click",A),h.addEventListener("click",j),x.addEventListener("keypress",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())}),f&&f.querySelectorAll(".s2c-quick-reply").forEach(function(e){e.addEventListener("click",function(){x.value=e.textContent,j(),f.style.display="none"})});d.appendChild(u),d.appendChild(b),d.addEventListener("keydown",function(e){"Escape"===e.key&&y&&(e.preventDefault(),A(),u.focus())}),void b.addEventListener("keydown",function(e){if("Tab"===e.key){var t=b.querySelectorAll('button:not([disabled]), input:not([disabled]), a[href], [tabindex]:not([tabindex="-1"])');if(0!==t.length){var i=t[0],r=t[t.length-1];e.shiftKey?d.activeElement!==i&&e.target!==i||(e.preventDefault(),r.focus()):d.activeElement!==r&&e.target!==r||(e.preventDefault(),i.focus())}}}),function(){if(!window.visualViewport)return;var e=window.visualViewport.height;window.visualViewport.addEventListener("resize",function(){if(y&&b){var t=e-window.visualViewport.height;t>100?(b.style.transform="translateY(-"+t+"px)",b.style.maxHeight=window.visualViewport.height-80+"px"):(b.style.transform="",b.style.maxHeight="")}})}(),Y(),function(){var e=history.pushState;history.pushState=function(){e.apply(this,arguments),setTimeout(Y,50)};var t=history.replaceState;history.replaceState=function(){t.apply(this,arguments),setTimeout(Y,50)},window.addEventListener("popstate",function(){setTimeout(Y,50)})}(),w.greeting&&T("assistant",w.greeting)}()}catch(e){console.error("Site2CRM Chat Widget: Init failed",e)}}function A(){y=!y,b.classList.toggle("open",y),b.setAttribute("aria-hidden",String(!y)),u.setAttribute("aria-label",y?"Close chat":"Open chat"),u.setAttribute("aria-expanded",String(y)),y&&x.focus()}function T(e,t){k.push({role:e,content:t});var i=document.createElement("div");i.className="s2c-message "+e,i.setAttribute("role","listitem"),"assistant"===e?i.innerHTML=function(e){function t(e){var t=e.toLowerCase();return t.includes("/signup")||t.includes("/register")?"Sign Up Free":t.includes("/pricing")?"View Pricing":t.includes("/demo")||t.includes("calendly")||t.includes("cal.com")?"Book Demo":t.includes("/trial")?"Start Free Trial":t.includes("/contact")?"Contact Us":t.includes("/schedule")||t.includes("/book")?"Schedule Now":t.includes("/form")||t.includes("/apply")?"Fill Out Form":t.includes("/download")?"Download":(t.includes("/learn")||t.includes("/docs"),"Learn More")}function i(e){return/^https?:\/\//i.test(e)?e:"https://"+e}var r=[];function a(e,a){var n=i(e),o='<br><a href="'+n+'" target="_blank" rel="noopener" class="s2c-link-btn">'+(a||t(n))+" "+E+"</a>",s="__LINK_PLACEHOLDER_"+r.length+"__";return r.push(o),s}var n=e;return n=l(n=(n=(n=n.replace(/\[([^\]]+)\]\(([^)]+)\)/g,function(e,t,i){return a(i,t)})).replace(/(https?:\/\/[^\s<]+[^\s<.,;:'")\]])/gi,function(e){return a(e)})).replace(/((?:www\.)?[a-zA-Z0-9][-a-zA-Z0-9]*\.(?:com|io|co|org|net|ai|app|dev)(?:\/[^\s<]*[^\s<.,;:'")\]])?)/gi,function(e){return e.includes("@")?e:a(e)})),r.forEach(function(e,t){n=n.replace("__LINK_PLACEHOLDER_"+t+"__",e)}),n}(t):i.textContent=t,g.appendChild(i),g.scrollTop=g.scrollHeight}function q(){var e=g.querySelector("[data-s2c-typing]");e&&e.remove()}async function j(){var e=x.value.trim();if(e&&!v){var i=Date.now();if(!(i-_<1e3)){var r;_=i,f&&(f.style.display="none"),T("user",e),x.value="",x.disabled=!0,h.disabled=!0,v=!0,(r=document.createElement("div")).className="s2c-typing",r.setAttribute("data-s2c-typing","1"),r.setAttribute("role","status"),r.setAttribute("aria-label","Assistant is typing"),r.innerHTML='<div class="s2c-typing-dot"></div><div class="s2c-typing-dot"></div><div class="s2c-typing-dot"></div>',g.appendChild(r),g.scrollTop=g.scrollHeight;var a=new AbortController,n=setTimeout(function(){a.abort()},15e3);try{var o=await fetch(c+"/message?widget_key="+t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:m,message:e,page_url:window.location.href,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),signal:a.signal});if(clearTimeout(n),q(),!o.ok)throw new Error("API error");var s=await o.json();T("assistant",s.response),s.lead_captured&&console.log("Site2CRM: Lead captured",s.captured_email||s.captured_phone)}catch(e){clearTimeout(n),q(),"AbortError"===e.name?T("assistant","Sorry, the response is taking too long. Please try again."):T("assistant","Sorry, I'm having trouble connecting. Please try again in a moment."),console.error("Site2CRM Chat Widget: Send failed",e)}finally{x.disabled=!1,h.disabled=!1,v=!1,x.focus()}}}}function Y(){if(p){var e=o();p.style.display=e?"none":"",e&&y&&A()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",L):L()}();